{
    "name": "AH Stock V9.0 Titan (8-Layer Shield)",
    "nodes": [
        {
            "parameters": {
                "rule": {
                    "interval": [
                        {
                            "field": "weeks",
                            "triggerAtDay": [
                                1,
                                2,
                                3,
                                4,
                                5
                            ],
                            "triggerAtHour": 18
                        }
                    ]
                }
            },
            "id": "5c911142-3f35-443d-9985-b8842143c0ad",
            "name": "å®šæ—¶è§¦å‘_å·¥ä½œæ—¥18ç‚¹",
            "type": "n8n-nodes-base.scheduleTrigger",
            "typeVersion": 1.1,
            "position": [
                -10000,
                1500
            ]
        },
        {
            "parameters": {
                "url": "https://jpthermjdexc.ap-northeast-1.clawcloudrun.com/market",
                "options": {}
            },
            "id": "5d329786-59f5-4c92-9da9-b4ca98821621",
            "name": "Global Context (API)",
            "type": "n8n-nodes-base.httpRequest",
            "typeVersion": 4.1,
            "position": [
                -9800,
                1500
            ],
            "retryOnFail": true,
            "maxTries": 3,
            "waitBetweenTries": 5000
        },
        {
            "parameters": {
                "documentId": {
                    "__rl": true,
                    "value": "https://docs.google.com/spreadsheets/d/1_MqQPC5DzLTarOM4hJ9_ajUX20piCiD6YmeM6Cp5Iys/edit?gid=0#gid=0",
                    "mode": "url"
                },
                "sheetName": {
                    "__rl": true,
                    "value": "stock list",
                    "mode": "name"
                },
                "options": {}
            },
            "id": "d9a24e99-acb2-407e-b1c0-a092aa9417eb",
            "name": "è¯»å–è‚¡ç¥¨åˆ—è¡¨",
            "type": "n8n-nodes-base.googleSheets",
            "typeVersion": 4.7,
            "position": [
                -9600,
                1500
            ],
            "credentials": {
                "googleSheetsOAuth2Api": {
                    "id": "OKN7AHfMulimnqoc",
                    "name": "Google Sheets account"
                }
            }
        },
        {
            "parameters": {
                "mode": "runOnceForAllItems",
                "jsCode": "\n// 1. è·å–æ‰€æœ‰è‚¡ç¥¨æ•°æ®\nconst items = $('è¯»å–è‚¡ç¥¨åˆ—è¡¨').all();\n\n// 2. åˆå§‹åŒ–å…¨å±€æ¸¸æ ‡\nlet staticData;\ntry {\n    staticData = getWorkflowStaticData('global');\n} catch(e) {\n    try {\n        staticData = $getWorkflowStaticData('global');\n    } catch(e2) {\n        console.log(\"Error getting static data: \" + e2.message);\n        throw new Error(\"Unable to access getWorkflowStaticData. Ensure Code Node Mode is 'Run Once for All Items'.\");\n    }\n}\n\nstaticData.nextIndex = 0;\nstaticData.total = items.length;\nstaticData.stockList = items.map(idx => idx.json);\n\nconsole.log(`Initialized Manual Loop. Total items: ${items.length}`);\nreturn { json: { status: \"Loop Initialized\", total: items.length } };\n"
            },
            "id": "43deeb24-4a62-403a-87d8-80be6b5b849c",
            "name": "åˆå§‹åŒ–å¾ªç¯",
            "type": "n8n-nodes-base.code",
            "typeVersion": 2,
            "position": [
                -9400,
                1500
            ]
        },
        {
            "parameters": {
                "mode": "runOnceForAllItems",
                "jsCode": "\nlet staticData;\ntry {\n    staticData = getWorkflowStaticData('global');\n} catch(e) {\n    staticData = $getWorkflowStaticData('global');\n}\n\nconst idx = staticData.nextIndex || 0;\nconst list = staticData.stockList;\n\nif (idx >= list.length) {\n    console.log(\"Loop Finished.\");\n    return null; // Stop workflow branch\n}\n\nconst currentStock = list[idx];\nconsole.log(`Processing Item ${idx + 1}/${list.length}: ${currentStock.code}`);\n\nstaticData.nextIndex = idx + 1;\n\nreturn { json: currentStock };\n"
            },
            "id": "d524db56-8553-4793-9044-243c5395f66c",
            "name": "æ‰‹å·¥å¾ªç¯æ§åˆ¶å™¨",
            "type": "n8n-nodes-base.code",
            "typeVersion": 2,
            "position": [
                -9200,
                1500
            ]
        },
        {
            "parameters": {
                "method": "POST",
                "url": "https://jpthermjdexc.ap-northeast-1.clawcloudrun.com/analyze_full",
                "sendBody": true,
                "bodyParameters": {
                    "parameters": [
                        {
                            "name": "code",
                            "value": "={{ $json.code }}"
                        },
                        {
                            "name": "balance",
                            "value": 100000
                        },
                        {
                            "name": "risk",
                            "value": 0.01
                        }
                    ]
                },
                "options": {
                    "timeout": 90000
                }
            },
            "id": "98fa8950-8eee-45eb-bdc8-d6626835c66c",
            "name": "Full Stack Analysis (API V9)",
            "type": "n8n-nodes-base.httpRequest",
            "typeVersion": 4.1,
            "position": [
                -9000,
                1500
            ],
            "retryOnFail": true,
            "maxTries": 3,
            "waitBetweenTries": 2000,
            "onError": "continueRegularOutput",
            "alwaysOutputData": true
        },
        {
            "parameters": {
                "method": "POST",
                "url": "https://api.tavily.com/search",
                "sendBody": true,
                "bodyParameters": {
                    "parameters": [
                        {
                            "name": "api_key",
                            "value": "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"
                        },
                        {
                            "name": "query",
                            "value": "={{ $json.name }} æœ€æ–°æ–°é—» åˆ©å¥½ åˆ©ç©º"
                        },
                        {
                            "name": "include_answer",
                            "value": "basic"
                        }
                    ]
                },
                "options": {
                    "timeout": 15000
                }
            },
            "id": "d25e1e2d-8b19-4921-a2f3-6ae76ed3ed1a",
            "name": "Tavilyæ–°é—»æœç´¢",
            "type": "n8n-nodes-base.httpRequest",
            "typeVersion": 4.3,
            "position": [
                -8800,
                1500
            ],
            "onError": "continueRegularOutput",
            "alwaysOutputData": true,
            "retryOnFail": true,
            "maxTries": 3,
            "waitBetweenTries": 2000
        },
        {
            "parameters": {
                "jsCode": "\nconst data = $json;\nconst marketStatus = $('Global Context (API)').first().json.market_status || \"Unknown\"; \n\nlet isError = false;\nlet errorMsg = \"\";\n\nif (data.error) {\n    isError = true;\n    errorMsg = JSON.stringify(data.error);\n} else if (!data.technical) {\n    isError = true;\n    errorMsg = \"API V9 returned no technical data (8-Layer Exhaustion).\";\n}\n\nif (isError) {\n    return {\n        json: {\n            prompt: `System Error Alert: The analysis API failed for stock ${data.code || 'unknown'}. Error: ${errorMsg}. Please generate a short report stating that data acquisition failed and human review is needed.`,\n            raw_data: data,\n            is_error: true\n        }\n    };\n}\n\nconst tech = data.technical || {};\nconst sig = data.signal || {};\nconst risk = data.risk_ctrl || {};\n\nlet news_text = \"æœªæœç´¢åˆ°æ–°é—»\";\ntry {\n    const news = $('Tavilyæ–°é—»æœç´¢').first().json; // Use first() logic safely\n    if (news.results) {\n        news_text = news.results.map(r => `- ${r.title}`).join('\\n');\n    } else if (news.answer) {\n        news_text = news.answer;\n    }\n} catch(e) {}\n\nconst prompt = `# å†³ç­–ä»ªè¡¨ç›˜åˆ†æè¯·æ±‚ (Titan V9 Core)\n\n## è‚¡ç¥¨åŸºç¡€\n- ä»£ç : ${data.code} (${data.market})\n- å¤§ç›˜ç¯å¢ƒ: ${marketStatus}\n- ç°ä»·: ${tech.current_price}\n\n## ä¿¡å·ç³»ç»Ÿ (8-Layer Shield)\n- æ ¸å¿ƒä¿¡å·: ${sig.signal}\n- è¶‹åŠ¿è¯„åˆ†: ${sig.trend_score}/100\n- ç†ç”±: ${sig.signal_reasons ? sig.signal_reasons.join(', ') : 'æ— '}\n\n## é£æ§å‚æ•°\n- æ­¢æŸä»·: ${sig.stop_loss}\n- ç›®æ ‡ä»·: ${sig.take_profit}\n- ATRæ³¢åŠ¨: ${tech.atr14}\n- å»ºè®®ä»“ä½: ${risk.suggested_position} æ‰‹ (åŸºäº1%é£é™©)\n\n## æŠ€æœ¯æŒ‡æ ‡\n- MAæ’åˆ—: ${tech.ma_alignment} (${tech.ma5}/${tech.ma20})\n- EMAè¶‹åŠ¿: 13æ—¥çº¿ ${tech.ema13} vs 26æ—¥çº¿ ${tech.ema26}\n- ä¹–ç¦»ç‡: ${tech.bias_ma5}%\n- RSI(14): ${tech.rsi14}\n- é‡æ¯”: ${tech.volume_ratio}\n\n## æ–°é—»æ‘˜è¦\n${news_text}\n\nè¯·åŸºäºä»¥ä¸Šæ•°æ®ï¼Œç”¨ç®€ç»ƒçš„ä¸“ä¸šæœ¯è¯­ç”Ÿæˆäº¤æ˜“è®¡åˆ’ã€‚`;\n\nlet risk_instruction = \"\";\nif (marketStatus === 'Bear' || marketStatus === 'Crash') {\n    risk_instruction = `\n!!! ğŸ”´ ä¸¥é‡è­¦å‘Šï¼šå½“å‰å¤„äºç†Šå¸‚/æš´è·Œç¯å¢ƒ (${marketStatus}) !!!\n1. **ä¸¥æ ¼æ ‡å‡†**ï¼šä»…å…è®¸è¯„åˆ†>85ä¸”æœ‰é‡å¤§åˆ©å¥½çš„ä¸ªè‚¡æ“ä½œã€‚\n2. **å¼ºåˆ¶è½»ä»“**ï¼šå»ºè®®ä»“ä½å¿…é¡»å‡åŠï¼Œæˆ–è€…ç›´æ¥å»ºè®®ç©ºä»“ã€‚\n3. **å¯»æ‰¾åšç©ºæœºä¼š**ï¼šå¦‚æœæ˜¯æ¸¯è‚¡ï¼Œä¼˜å…ˆå¯»æ‰¾åšç©ºé€»è¾‘ï¼›å¦‚æœæ˜¯Aè‚¡ï¼Œå»ºè®®ä»¥â€œè§‚æœ›â€ä¸ºä¸»ã€‚\n4. **æªè¾ä¸¥å‰**ï¼šè¯·åœ¨æ ¸å¿ƒç»“è®ºä¸­ç”¨ç²—ä½“å¼ºè°ƒå¤§ç›˜é£é™©ã€‚`;\n}\n\nreturn {\n    json: {\n        prompt: prompt + risk_instruction,\n        technical: tech, \n        raw_data: data\n    }\n};\n"
            },
            "id": "539b4ffa-c95d-4965-ba8c-5d233d78a36f",
            "name": "æ„å»ºAIæç¤ºè¯",
            "type": "n8n-nodes-base.code",
            "typeVersion": 2,
            "position": [
                -8600,
                1500
            ],
            "onError": "continueRegularOutput",
            "alwaysOutputData": true
        },
        {
            "parameters": {
                "modelName": "models/gemini-3-flash-preview",
                "options": {}
            },
            "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
            "typeVersion": 1,
            "position": [
                -8600,
                1700
            ],
            "id": "297588f1-04be-4470-b0a0-1812fd4dae6a",
            "name": "Google Gemini Chat Model",
            "credentials": {
                "googlePalmApi": {
                    "id": "V4cRtuj3j8gaQfEU",
                    "name": "Google Gemini(PaLM) Api account"
                }
            }
        },
        {
            "parameters": {
                "promptType": "define",
                "text": "={{ $json.prompt }}",
                "options": {
                    "systemMessage": "You are a professional Financial Analyst Agent (Titan Edition). \nYour Role: Analyze stock data (Technical + Fundamental + News) and generate a clear, actionable trading plan in structured JSON format.\n\n### Input Data:\n- Technical Indicators (MA, RSI, ATR, etc.)\n- Signal Logic (V9.0 8-Layer Shield)\n- Market Context (Bull/Bear/Crash)\n- News Summary (Chinese)\n\n### Language Requirement:\n- **JSON Keys**: MUST be in English (e.g. `analysis_summary`).\n- **Content Values**: MUST be in **Simplified Chinese (ç®€ä½“ä¸­æ–‡)** (e.g. `\"trend_prediction\": \"çœ‹æ¶¨\"`)\n\n### Output Requirement:\nReturn ONLY a valid JSON object. No markdown formatting, no code blocks (` ```json `), just the raw JSON.\n\n### JSON Schema:\n{\n  \"stock_name\": \"String\",\n  \"analysis_summary\": \"One sentence summary in Chinese\",\n  \"trend_prediction\": \"Bullish/Bearish/Neutral (translate to Chinese)\",\n  \"sentiment_score\": 0-100,\n  \"decision_type\": \"buy/sell/hold/wait\",\n  \"operation_advice\": \"Clear instruction in Chinese\",\n  \"dashboard\": {\n    \"core_conclusion\": {\n      \"signal_type\": \"Strong Buy/Buy/Wait/Sell\",\n      \"one_sentence\": \"Detailed reasoning in Chinese...\",\n      \"position_advice\": {\n        \"no_position\": \"Wait / Open 10%\",\n        \"has_position\": \"Hold / Reduce / Clear\"\n      }\n    },\n    \"battle_plan\": {\n      \"sniper_points\": {\n        \"ideal_buy\": 0.00,\n        \"stop_loss\": 0.00,\n        \"take_profit\": 0.00\n      },\n      \"checklist\": [\"MA Alignment OK\", \"RSI Neutral\", \"Volume High\"]\n    },\n    \"intelligence\": {\n      \"risk_alerts\": [\"Risk 1\", \"Risk 2\"],\n      \"sentiment_summary\": \"News analysis in Chinese...\"\n    }\n  }\n}\n\n### Rules:\n1. If Market is 'Bear' or 'Crash', be extremely conservative. Penalize score by 20 points.\n2. Stop Loss must be respected. If current price < stop loss, decision is SELL.\n3. Do not hallucinate data. Use provided numbers."
                }
            },
            "id": "27cc44c4-826c-49bb-b8c7-5025005269a0",
            "name": "AIåˆ†æAgent",
            "type": "@n8n/n8n-nodes-langchain.agent",
            "typeVersion": 2,
            "position": [
                -8400,
                1500
            ],
            "onError": "continueRegularOutput",
            "alwaysOutputData": true,
            "retryOnFail": true,
            "maxTries": 3,
            "waitBetweenTries": 2000
        },
        {
            "parameters": {
                "jsCode": "\n// ã€å…¨é€‰æ›¿æ¢ã€‘è§£æAIåˆ†æç»“æœ - ç»ˆæä¿®å¤ç‰ˆ (V9.1 Sync)\nconst aiOutput = $json.output || $json.content || $json.response || $json;\n\n// 2. ã€å…³é”®ä¿®å¤ã€‘ä» \"æ„å»ºAIæç¤ºè¯\" èŠ‚ç‚¹æ‰¾å›åŸå§‹æŠ€æœ¯æ•°æ®\nlet technical, rawData;\ntry {\n  const upstream = $('æ„å»ºAIæç¤ºè¯').last().json;\n  technical = upstream.technical || {};\n  rawData = upstream.raw_data || {};\n} catch (e) {\n  technical = $json.technical || {}; \n  rawData = $json.raw_data || {};\n}\n\ntry {\n  let jsonStr = typeof aiOutput === 'string' ? aiOutput : JSON.stringify(aiOutput);\n  if (jsonStr.includes('```json')) {\n    jsonStr = jsonStr.replace(/```json\\n?/g, '').replace(/```\\n?/g, '');\n  } else if (jsonStr.includes('```')) {\n    jsonStr = jsonStr.replace(/```\\n?/g, '');\n  }\n  \n  const jsonStart = jsonStr.indexOf('{');\n  const jsonEnd = jsonStr.lastIndexOf('}') + 1;\n  if (jsonStart >= 0 && jsonEnd > jsonStart) {\n    jsonStr = jsonStr.substring(jsonStart, jsonEnd);\n  }\n  \n  const data = JSON.parse(jsonStr);\n  const dashboard = data.dashboard || {};\n  \n  // Fallback Source: rawData > technical\n  const fallbackStopLoss = rawData.stop_loss || rawData.signal?.stop_loss || 0;\n  const fallbackTakeProfit = rawData.take_profit || rawData.signal?.take_profit || 0;\n  const fallbackSignal = rawData.signal_type || rawData.signal?.signal || 'è§‚æœ›';\n  \n  const result = {\n    date: new Date().toISOString().split('T')[0],\n    code: technical.code || rawData.code || \"unknown\",\n    market: technical.market || rawData.market || \"CN\",\n    name: data.stock_name || technical.name || rawData.name || rawData.code,\n    \n    signal_type: dashboard.core_conclusion?.signal_type || data.trend_prediction || fallbackSignal,\n    sentiment_score: data.sentiment_score || 50,\n    operation_advice: data.operation_advice || 'è§‚æœ›',\n    decision_type: data.decision_type || 'hold',\n    one_sentence: dashboard.core_conclusion?.one_sentence || data.analysis_summary || '',\n    \n    advice_no_position: dashboard.core_conclusion?.position_advice?.no_position || '',\n    advice_has_position: dashboard.core_conclusion?.position_advice?.has_position || '',\n    \n    entry_price: dashboard.battle_plan?.sniper_points?.ideal_buy || technical.support_level || 0,\n    stop_loss: dashboard.battle_plan?.sniper_points?.stop_loss || fallbackStopLoss,\n    take_profit: dashboard.battle_plan?.sniper_points?.take_profit || fallbackTakeProfit,\n    \n    current_price: technical.current_price,\n    atr14: technical.atr14,\n    bias_ma5: technical.bias_ma5,\n    rsi14: technical.rsi14,\n    volume_ratio: technical.volume_ratio,\n    ma_alignment: technical.ma_alignment,\n    \n    checklist: dashboard.battle_plan?.checklist?.join('\\n') || '',\n    risk_alerts: dashboard.intelligence?.risk_alerts?.join('\\n') || '',\n    news_summary: dashboard.intelligence?.sentiment_summary || '',\n    \n    raw_analysis: data\n  };\n  \n  return [{ json: result }];\n  \n} catch (error) {\n  return [{\n    json: {\n      date: new Date().toISOString().split('T')[0],\n      code: technical?.code || 'ERROR',\n      name: technical?.name,\n      signal_type: 'è§£æå¤±è´¥',\n      one_sentence: 'AIè¿”å›æ ¼å¼å¼‚å¸¸',\n      current_price: technical?.current_price || 0,\n      bias_ma5: technical?.bias_ma5 || 0,\n      error: error.message,\n      raw_output: aiOutput\n    }\n  }];\n}\n"
            },
            "id": "6cab7481-f9b6-411b-82bd-3ee1eb3ec4be",
            "name": "è§£æAIåˆ†æç»“æœ",
            "type": "n8n-nodes-base.code",
            "typeVersion": 2,
            "position": [
                -8200,
                1500
            ],
            "onError": "continueRegularOutput",
            "alwaysOutputData": true
        },
        {
            "parameters": {
                "resource": "bitable",
                "operation": "bitable:table:record:batchAdd",
                "app_toke": "RVghbRvYgacqs3s82qkcl83bn7e",
                "table_id": "tblvrNDNrjAZwBZc",
                "body": "={{\nJSON.stringify({\n  \"records\": [\n    {\n      \"fields\": {\n        \"æ—¥æœŸ\": new Date().getTime(),\n        \"ä»£ç \": $json.code || \"ERR\",\n        \"åç§°\": $json.name || \"Unknown\",\n        \"å¤§ç›˜çŠ¶æ€\": $json.market || \"Unknown\", \n        \"ä¿¡å·ç±»å‹\": $json.signal_type || \"æ— ä¿¡å·\",\n        \"æ“ä½œå»ºè®®\": $json.operation_advice, \n        \"æ ¸å¿ƒç»“è®º\": $json.one_sentence,\n        \"å»ºè®®ä»“ä½(æ‰‹)\": $json.advice_has_position, \n        \"æ­¢æŸä»·\": $json.stop_loss,\n        \"ATR\": $json.atr14,\n        \"RSI\": $json.rsi14,\n        \"é‡æ¯”\": $json.volume_ratio,\n        \"å‡çº¿å½¢æ€\": $json.ma_alignment,\n        \"é£é™©è­¦æŠ¥\": $json.risk_alerts,\n        \"æ£€æŸ¥æ¸…å•\": $json.checklist\n      }\n    }\n  ]\n})\n}}"
            },
            "id": "24f6067c-4f52-4edb-b8c3-a5510d3630d0",
            "name": "å†™å…¥é£ä¹¦",
            "type": "n8n-nodes-feishu-lite.feishuNode",
            "typeVersion": 1,
            "position": [
                -8000,
                1500
            ],
            "credentials": {
                "feishuCredentialsApi": {
                    "id": "RcP0KB4O5l2Y95Bs",
                    "name": "Feishu account 2"
                }
            },
            "onError": "continueRegularOutput",
            "alwaysOutputData": true,
            "retryOnFail": true,
            "maxTries": 3,
            "waitBetweenTries": 2000
        },
        {
            "parameters": {
                "mode": "runOnceForEachItem",
                "jsCode": "\n// ã€V7.6 Data Flow Fixã€‘\nconst sourceNode = $('è§£æAIåˆ†æç»“æœ');\nlet sourceData = {};\n\nif (sourceNode && sourceNode.last()) {\n    sourceData = sourceNode.last().json;\n} else {\n    sourceData = $json; \n}\nconst root = sourceData; \n\nconst signal = root.signal_type || \"æ— ä¿¡å·\";\nconst score = root.sentiment_score || 0;\nconst advice = root.operation_advice || \"æš‚æ— å»ºè®®\";\nconst summary = root.one_sentence || \"æ— è¯¦ç»†ç»“è®º\";\nconst stockName = root.name || \"è‚¡ç¥¨\";\nconst code = root.code || \"\";\nconst currentPrice = root.current_price || 0;\nconst stopLoss = root.stop_loss || 0;\nconst takeProfit = root.take_profit || 0;\n\nlet color = 'grey'; \nconst sigStr = signal.toString();\nif (sigStr.includes('ä¹°å…¥') || sigStr.includes('Buy')) {\n    color = 'green'; \n} else if (sigStr.includes('å–å‡º') || sigStr.includes('å‡ä»“')) {\n    color = 'red';   \n} else if (sigStr.includes('é£é™©') || sigStr.includes('Warn')) {\n    color = 'orange';\n}\n\nconst cardContent = [\n  {\n    tag: 'div',\n    text: {\n      tag: 'lark_md',\n      content: `**${signal}** | è¯„åˆ†: **${score}**/100 | ${advice}`\n    }\n  },\n  { tag: 'hr' },\n  {\n    tag: 'div',\n    text: {\n      tag: 'lark_md',\n      content: `ğŸ’¡ **æ ¸å¿ƒç»“è®º**ï¼š\\n${summary}`\n    }\n  },\n  {\n    tag: 'div',\n    text: {\n      tag: 'lark_md',\n      content: `ğŸ’° ç°ä»·: **${currentPrice}** | æ­¢æŸ: ${stopLoss} | ç›®æ ‡: ${takeProfit}`\n    }\n  },\n  {\n    tag: 'action',\n    actions: [\n      {\n        tag: 'button',\n        text: { tag: 'plain_text', content: 'ğŸ“Š æŸ¥çœ‹å®Œæ•´æ•°æ®è¡¨' },\n        type: (color === 'green') ? 'primary' : 'default',\n        url: 'https://xcnf59usubzt.feishu.cn/base/RVghbRvYgacqs3s82qkcl83bn7e?table=tblvrNDNrjAZwBZc'\n      }\n    ]\n  },\n  {\n    tag: 'note',\n    elements: [\n      { tag: 'plain_text', content: `V9.0 Titan | ${stockName}(${code})` }\n    ]\n  }\n];\n\nreturn {\n  json: {\n    card_color: color,\n    card_content: cardContent,\n    header_title: `ğŸ“Š ${stockName} æ¯æ—¥åˆ†æ`\n  }\n};\n"
            },
            "id": "5859e200-0525-4456-9fb2-9692d2037360",
            "name": "æ„å»ºé€šç”¨å¡ç‰‡",
            "type": "n8n-nodes-base.code",
            "typeVersion": 2,
            "position": [
                -7800,
                1500
            ],
            "onError": "continueRegularOutput",
            "alwaysOutputData": true
        },
        {
            "parameters": {
                "resource": "message",
                "operation": "message:send",
                "receive_id_type": "user_id",
                "receive_id": "bg99a8dc",
                "msg_type": "interactive",
                "content": "={{\nJSON.stringify({\n  \"config\": {\n    \"wide_screen_mode\": true\n  },\n  \"header\": {\n    \"template\": $json.card_color,\n    \"title\": {\n      \"content\": $json.header_title,\n      \"tag\": \"plain_text\"\n    }\n  },\n  \"elements\": $json.card_content\n})\n}}"
            },
            "id": "d7aa6412-4349-4ba1-bd9d-8f6cae75e375",
            "name": "å‘é€é€šç”¨æ¶ˆæ¯",
            "type": "n8n-nodes-feishu-lite.feishuNode",
            "typeVersion": 1,
            "position": [
                -7600,
                1500
            ],
            "credentials": {
                "feishuCredentialsApi": {
                    "id": "RcP0KB4O5l2Y95Bs",
                    "name": "Feishu account 2"
                }
            },
            "onError": "continueRegularOutput",
            "alwaysOutputData": true,
            "retryOnFail": true,
            "maxTries": 3,
            "waitBetweenTries": 2000
        },
        {
            "parameters": {
                "amount": 3,
                "unit": "seconds"
            },
            "id": "6136daf2-ae7c-41e3-9eba-a889103e1c1e",
            "name": "å®‰æŠšåçˆ¬è™« (Wait 3s)",
            "type": "n8n-nodes-base.wait",
            "typeVersion": 1,
            "position": [
                -7400,
                1500
            ]
        }
    ],
    "connections": {
        "å®šæ—¶è§¦å‘_å·¥ä½œæ—¥18ç‚¹": {
            "main": [
                [
                    {
                        "node": "Global Context (API)",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "Global Context (API)": {
            "main": [
                [
                    {
                        "node": "è¯»å–è‚¡ç¥¨åˆ—è¡¨",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "è¯»å–è‚¡ç¥¨åˆ—è¡¨": {
            "main": [
                [
                    {
                        "node": "åˆå§‹åŒ–å¾ªç¯",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "åˆå§‹åŒ–å¾ªç¯": {
            "main": [
                [
                    {
                        "node": "æ‰‹å·¥å¾ªç¯æ§åˆ¶å™¨",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "æ‰‹å·¥å¾ªç¯æ§åˆ¶å™¨": {
            "main": [
                [
                    {
                        "node": "Full Stack Analysis (API V9)",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "Full Stack Analysis (API V9)": {
            "main": [
                [
                    {
                        "node": "Tavilyæ–°é—»æœç´¢",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "Tavilyæ–°é—»æœç´¢": {
            "main": [
                [
                    {
                        "node": "æ„å»ºAIæç¤ºè¯",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "æ„å»ºAIæç¤ºè¯": {
            "main": [
                [
                    {
                        "node": "AIåˆ†æAgent",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "AIåˆ†æAgent": {
            "main": [
                [
                    {
                        "node": "è§£æAIåˆ†æç»“æœ",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "è§£æAIåˆ†æç»“æœ": {
            "main": [
                [
                    {
                        "node": "å†™å…¥é£ä¹¦",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "å†™å…¥é£ä¹¦": {
            "main": [
                [
                    {
                        "node": "æ„å»ºé€šç”¨å¡ç‰‡",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "æ„å»ºé€šç”¨å¡ç‰‡": {
            "main": [
                [
                    {
                        "node": "å‘é€é€šç”¨æ¶ˆæ¯",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "å‘é€é€šç”¨æ¶ˆæ¯": {
            "main": [
                [
                    {
                        "node": "å®‰æŠšåçˆ¬è™« (Wait 3s)",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "å®‰æŠšåçˆ¬è™« (Wait 3s)": {
            "main": [
                [
                    {
                        "node": "æ‰‹å·¥å¾ªç¯æ§åˆ¶å™¨",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "Google Gemini Chat Model": {
            "ai_languageModel": [
                [
                    {
                        "node": "AIåˆ†æAgent",
                        "type": "ai_languageModel",
                        "index": 0
                    }
                ]
            ]
        }
    },
    "settings": {},
    "meta": {}
}